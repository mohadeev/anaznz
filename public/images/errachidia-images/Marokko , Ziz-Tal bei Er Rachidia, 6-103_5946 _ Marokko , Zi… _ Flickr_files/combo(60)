YUI.add("hermes-lang-policy-terms",function(o,O){o.Intl.add("hermes/policy-terms","en-US",{DOWNLOAD_TERMS_OF_SERVICE:["Download Terms of Service"],DOWNLOAD_PRIVACY_POLICY:["Download Privacy Policy"],DOWNLOAD_API_TERMS:["Download API Terms of Service"],DOWNLOAD_COMMUNITY_GUIDELINES:["Download Community Guidelines"],DOWNLOAD_COOKIE_POLICY:["Download Cookie Policy"],DOWNLOAD_DATA_PROCESSING_POLICY:["Download Data Processing Policy"],POLICIES_AND_GUIDELINES:["Policies & Guidelines"],TERMS:["Terms"],PRIVACY:["Privacy"],API:["API"],COMMUNITY:["Community"],COOKIES:["Cookies"],DATA_PROCESSING:["Data Processing"]})},"@VERSION@",{requires:["intl"]});YUI.add("global-nav-view",function(e,t){require("hermes-core/flog")(t);var n=new e.SubscriptionsHelper;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var n,i;if(void 0===t.enableBrowserUpgradeBanner&&(t.enableBrowserUpgradeBanner=!0),this.set("showBrowserUpgradeBanner",!1),YUI.Env.isServer&&t.enableBrowserUpgradeBanner){var o=this.appContext.request.headers["user-agent"],r=e.BrowserSupport.isUnsupportedBrowser(o),a=e.BrowserSupport.isBot(o),s=e.BrowserSupport.isSharingBot(o);!r||a||s||this.set("showBrowserUpgradeBanner",!0)}if(!YUI.Env.isServer){var l=e.StorageHelper.getItem("hasDismissedBrowserUpgradeBanner",!0);l&&"true"===l&&this.set("showBrowserUpgradeBanner",!1)}return""===this.get("container").get("innerHTML")&&this.setContainerHTML('<div class="global-nav-content"></div>'),this.appStateParams=t,this.themeClass=t.theme||"default-theme",n=this.appContext.getLocation(),i=t.modelParams&&t.modelParams.apiParams?t.modelParams.apiParams:n.href,this.searchUrl=new e.SearchUrl(i,this.appContext,t.searchType),this.isSOHP=t.isSOHP,this.isProPage=t.isProPage,this.disableMobileNav=t.disableMobileNav,this.hideBanner=t.isSearchResults,this.isRefencingAnnouncementPage=t.isRefencingAnnouncementPage,this.uploadLimitDismissHours=48,this.isDesktopWidthBreakpoint=1080,this.photoPrintsHelper=new e.PhotoPrintsHelper(this.appContext),this.mathHelper=new e.MathHelper,this},subviewConfig:{"search-autosuggest-field-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,isSOHP:this.isSOHP},"account-menu-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"notifications-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(){return!this.appContext.getViewer().signedIn}},"browser-upgrade-banner-view":{requiredToShowOnServer:!0,requiredToShowOnClient:!1,dealbreaker:!1,disabled:function(){return!this.get("showBrowserUpgradeBanner")}},"person-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,containerSelector:"#content, #stacking-overlay-container",excludeSelectors:[".c-account-menu"]},"group-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,containerSelector:"#content, #stacking-overlay-container",excludeSelectors:[".c-account-menu"]},"partner-account-banner-view":{requiredToShowOnServer:!1,requiredToShowOnClient:!1},"featured-toast-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"slim-footer-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,additionalViewClasses:["navbar-footer-placement","mobile-nav-drawer-list"],disabled:function(){return!this.appContext.flipper.isFlipped("enable-cookie-consent-execution-hermes")}}},loadState:function(){var t=this,n=this.appContext.getViewer(),i=[];return n.signedIn?(i.push(this.appContext.getModel("person-models",n.nsid).then(function(e){t.set("viewer",e),t.elementStates=t.setElementStates(t.appStateParams)})),i.push(this.appContext.getModel("person-profile-models",n.nsid).then(function(e){t.profileModel=e}))):this.elementStates=this.setElementStates(this.appStateParams),e.Promise.all(i).then(function(){var n=t.get("viewer"),i=n?n.getValue("nsid"):void 0;if(!i)return e.Promise.resolve();if(t.appContext.flipper.isFlipped("enable-feedback-modal")){var o=parseInt(i.substring(0,i.indexOf("@"))),r=0,a=0,s=e.config.flickr.geo,l=!1;s?"US"===s.countryCode?(a=0,r=0):"CA"===s.countryCode?(a=0,r=0):"GB"===s.countryCode?(a=0,r=0):["AU","TW","JP"].indexOf(s.countryCode)>-1?(a=0,r=0):["FR","DE","NL","ES","IT"].indexOf(s.countryCode)>-1?(a=0,r=0):l=!1:l=!1;var c=!0;o&&(c=t.appContext.viewportData.getWidth()>700?t.mathHelper.seedRandom(o)<r:t.mathHelper.seedRandom(o)<a),!YUI.Env.isServer&&"en-US"===t.appContext.lang&&c&&l&&this.appContext.getViewer().signedIn&&"photostream-route"!==this.appContext.routeConfig.module&&!localStorage.getItem("propricingsurvey2021")&&(t.meetsFeedbackCriteria=!0)}})},buildContainer:function(){var t,i={},o=this.appContext.getViewer().signedIn;return this.get("viewer")&&(i=e.merge(this.get("viewer").toJSON(),{urls:e.URLHelper.generatePersonUrls(this.get("viewer"))})),t={theme:this.themeClass,disableMobileNav:this.disableMobileNav,"show-browser-upgrade-banner":this.get("showBrowserUpgradeBanner"),showNotificationsMenu:!1,viewer:i,isSignedIn:o,elements:this.elementStates,isRefencingAnnouncementPage:this.isRefencingAnnouncementPage,upgradeProLink:n.getProLandingPageUrl(n.UTM_GLOBAL_NAV)},o&&(t["notifications-menu-view"]=this.subviews["notifications-menu-view"].get("container"),t.showNotificationsMenu=!0),this.photoPrintsHelper.isPrintsEnabled()&&(t.printCartUrl=this.photoPrintsHelper.getCartUrl()),this.setContainerWithTemplate("global-nav",t),this},activate:function(){var n=this,i=(this.appContext.flapp.get("activeView").name,this.get("container")),o=this.appContext.getViewer(),r=i.one(".gn-upload .gn-title");return this.contentContainer=i.one(".global-nav"),i.one(".mobile-nav-toggle")&&(this.navDrawer=i.one(".mobile-nav-drawer"),this.navDrawerOverlay=i.one(".mobile-nav-drawer-overlay"),this.registerEventHandler(i.one(".mobile-nav-toggle").on("click",function(e){n.navDrawerShown?n.hideMobileNavDrawer():n.showMobileNavDrawer()})),this.registerEventHandler(this.navDrawer.delegate("click",this.handleDrawerItemClick.bind(this),".mobile-nav-menu-item"))),i.one(".mobile-search-button")?(this.registerEventHandler(i.one(".mobile-search-button").on("click",function(e){n.contentContainer.addClass("search-open"),n.fire("parentViewEvent","focus-search-field"),i.one(".flickr-logo-container").addClass("hidden")}.bind(this))),this.registerEventHandler(e.on("add-context-to-search-field",function(e){n.contentContainer.addClass("search-open"),n.fire("parentViewEvent","focus-search-field")},this))):this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(t){var o=e.config.win.innerWidth<=this.isDesktopWidthBreakpoint,r=o?this.appContext.viewportData.getWidth():0,a=o?46:0;o||(n.contentContainer.removeClass("search-open"),i.one(".flickr-logo-container").removeClass("hidden")),n.fire("parentViewEvent","resize-search-field",r-a)}.bind(this))),i.one(".mobile-search-close-button")&&this.registerEventHandler(i.one(".mobile-search-close-button").on("click",function(e){n.contentContainer.removeClass("search-open"),i.one(".flickr-logo-container").removeClass("hidden"),n.fire("parentViewEvent","clear-search-field")}.bind(this))),o.signedIn||r&&this.registerEventHandler(r.on("click",this.signUpAndUpload.bind(this))),e.AnchorRepositioner.addOffset(t,i),this.registerEventHandler(i.delegate("keydown",this.toggleSubmenu.bind(this),"a[aria-haspopup=true]")),this.registerEventHandler(i.delegate("keydown",this.enterSubmenu.bind(this),"a[aria-haspopup=true]")),this.registerEventHandler(i.on("keydown",this.goToSubmenuHeading.bind(this),"ul.gn-submenu")),this.registerEventHandler(i.delegate("keydown",this.keyboardNavigation.bind(this),"ul.nav-menu")),this.registerEventHandler(i.delegate("mouseup",this.toggleAriaExpanded.bind(this),"a[aria-haspopup=true]")),this.showFeedbackModal(),this.toastSubview=this.subviews["featured-toast-view"],this.registerEventHandler(e.on("accountCard:overLimitLearnMoreClick",function(){n.showOverLimitToast()})),this.registerEventHandler(e.on("printsPage:choosePhotosClicked",function(){n.handlePrintClick()})),this.photoPrintsHelper.isPrintsEnabled()&&(this.printsButton=i.one(".gn-create .prints-button"),this.mobilePrintsButton=i.one(".mobile-nav-drawer .prints-button"),this.cartLink=i.one(".gn-create .cart-link"),this.mobileCartLink=i.one(".mobile-nav-drawer .cart-link"),this.printsButton&&this.registerEventHandler(this.printsButton.on("click",this.handlePrintClick.bind(this))),this.mobilePrintsButton&&this.registerEventHandler(this.mobilePrintsButton.on("click",this.handlePrintClick.bind(this))),(this.cartLink||this.mobileCartLink)&&(this.photoPrintsHelper.fetchCartCount().then(function(e){var t=e?e.count:0,i=n.intlMessage({intlName:"prints.VIEW_CART_WITH_COUNT",count:void 0!==t?t.toString():"0"});t>0&&(n.cartLink.removeClass("disabled"),n.mobileCartLink.removeClass("disabled")),n.cartLink.set("innerHTML",i),n.mobileCartLink.set("innerHTML",i)}).catch(function(e){var t=n.intlMessage({intlName:"prints.VIEW_CART_WITH_COUNT",count:"0"});n.cartLink.set("innerHTML",t),n.mobileCartLink.set("innerHTML",t)}),this.prepareOrderConfirmationModal())),this.appContext.bannerManager.loadBanners([{type:"loginMigration",priority:2,placement:"header"},{type:"pastDue",priority:1,placement:"header"},{type:"migrateSubscription",priority:0,placement:"header"},{type:"cookieConsent",priority:0,placement:"footer"},{type:"cookie",priority:0,placement:"footer"},{type:"uploadLimit",priority:0,placement:"toast"},{type:"bfcmBanner",priority:3,placement:"header"},{type:"ybsExplore",priority:4,placement:"header"},{type:"likesAnnouncement",priority:4,placement:"header"}]).then(function(){var e=this.appContext.bannerManager.getBanners(["header","footer"]);0===e.length&&(e=this.appContext.bannerManager.getBanners(["toast"])),e.forEach(function(e){return this.appContext.bannerManager.renderBannerView(e)})}),this.registerEventHandler(this.appContext.bannerManager.on("renderBanner",function(t){var o,r,a;return"header"===t.placement?(o=t.bannerView,r=o.get("container"),(a=i.one(".nav-banner-container")).empty(),a.appendChild(r),o.on("subviewActivated",function(){e.fire("globalNav:bannerSubviewActivated")}),o.on("dismissed",function(){o.get("container").remove(),o.destroy(),e.fire("globalNav:bannerDismissed")}),o.normalizedActivate()):"toast"===t.placement?(o=t.bannerView,r=o.get("container"),o.activate().then(function(){var e=o.subview;n.toastSubview.setup(e.featuredToastConfig),n.toastSubview.on("primaryActionClicked",function(t){e.handleToastPrimaryActionClick(t)}),n.toastSubview.on("secondaryActionClicked",function(t){e.handleToastSecondaryActionClick(t)}),o.on("dismissed",function(){n.toastSubview.dismiss()}),n.toastSubview.show()})):void 0})),this},showFeedbackModal:function(){var t=this,n=e.QueryString.parse(e.config.win.location.search.replace("?","")),i=e.config.win.location.href,o=e.config.flickr.geo;if(t.appContext.flipper.isFlipped("enable-feedback-modal")&&n&&void 0!==n.survey&&(i=i.replace("?survey",""),e.config.win.history.replaceState({},"",i),this.meetsFeedbackCriteria=!0),this.meetsFeedbackCriteria){var r,a=this.templates("feedback-modal-view")({}),s=[];return this.appContext.getViewer().signedIn&&s.push(this.appContext.getModel("person-profile-models",t.get("viewer").id).then(function(e){t.profileModel=e})),e.Promise.all(s).then(function(){var n,i="W895K8X";(n=new e.Views.FluidModal({appContext:t.appContext,noScroll:!0,hideModalOverlay:!1,maxHeight:!1,showFooter:!1,classList:"modal-restyle",width:560,htmlMessage:a})).show(),o&&o.countryCode&&("US"===o.countryCode?i="W895K8X":"CA"===o.countryCode?i="W9QJDPJ":"GB"===o.countryCode?i="W7QLXWH":["FR","DE","NL","ES","IT"].indexOf(o.countryCode)>-1?i="WY2DXWQ":["AU","TW","JP"].indexOf(o.countryCode)>-1&&(i="WC8GLD9")),n.on("activated",function(){r=n.get("container").one(".accept-button"),n.get("container").one(".cancel-button").on("click",function(e){n.close()}),r.on("click",function(e){function a(e,t){var n=(m?"":"&")+e+"="+encodeURIComponent(t);return m=!1,n}var s,l,c,h,d="https://www.surveymonkey.com/r/"+i+"?",p=0,u=(t.appContext.getViewer().signedIn,t.appContext.viewportData.getWidth()>700?"Desktop":"Mobile"),g=t.appContext.getViewer().isPro,m=!0;r.setAttribute("disabled"),t.appContext.getViewer().signedIn&&(s=t.appContext.getViewer().nsid,h=t.get("viewer").getValue("dateCreated"),t.get("viewer").getValue("dateCreated")&&(p=h.year())),t.profileModel&&(l=t.profileModel.getValue("photoCount")),l&&(d+=a("nop",l)),void 0!==p&&(d+=a("y",p)),s&&(d+=a("id",s)),d+=a("at",g?"pro":"free"),u&&(d+=a("d",u)),o&&o.countryCode&&(c=o.countryCode),c&&(d+=a("cc",c)),window.open(d,"_blank"),n.close()})}),n.on("close",function(){localStorage.setItem("propricingsurvey2021",!0)})})}},clearKeyboardFocus:function(e){this.get("container").all(".has-keyboard-focus").removeClass("has-keyboard-focus"),this.get("container").all(".nav-menu a[aria-expanded=true]").setAttribute("aria-expanded","false")},toggleAriaExpanded:function(e){e.target.setAttribute("aria-expanded","false"===e.target.getAttribute("aria-expanded")?"true":"false")},enterSubmenu:function(e){if(40===e.keyCode){e.preventDefault();var t=e.target.next("ul");t&&t.hasClass("has-keyboard-focus")&&t.one(":first-child").one(":first-child").focus()}},toggleSubmenu:function(e){var t=e.keyCode;if(13===t||32===t){e.preventDefault();var n=e.target.next("ul");n&&(n.hasClass("has-keyboard-focus")?this.clearKeyboardFocus():(n.addClass("has-keyboard-focus"),e.target.setAttribute("aria-expanded","true")))}},goToSubmenuHeading:function(e,t){var n;(t||27===e.keyCode)&&(t||this.clearKeyboardFocus(),e.target.hasClass("gn-submenu")?n=e.target.previous("a"):e.target.ancestor("ul.gn-submenu")&&(n=e.target.ancestor("ul.gn-submenu").previous("a")),n&&n.focus())},keyboardNavigation:function(e){var t=e.keyCode,n=9===t&&e.shiftKey,i=9===t&&!e.shiftKey;e.target.hasClass("gn-title")?(n=(37===t||n)&&e.target.ancestor("li").previous("li"),i=(39===t||i)&&!!e.target.ancestor("li").next("li"),n?(this.clearKeyboardFocus(),this.focusOnPreviousItem(e)):!i||e.target.next("ul")&&e.target.next("ul").hasClass("has-keyboard-focus")||(this.clearKeyboardFocus(),this.focusOnNextItem(e))):38===t||n?this.focusOnPreviousItem(e):(40===t||i)&&this.focusOnNextItem(e)},focusOnPreviousItem:function(e){e.preventDefault();var t=e.target.ancestor("li").previous("li:not(.divider)");t?t.one(":first-child").focus():e.target.ancestor("ul.gn-submenu")&&this.goToSubmenuHeading(e,!0)},focusOnNextItem:function(e){e.preventDefault();var t=e.target.ancestor("li").next("li:not(.divider)");t&&t.one(":first-child").focus()},signUpAndUpload:function(t){var n,i=e.url("/upload/"),o=this.intlMessage({intlName:"global-nav.UPLOAD_MODAL_SIGNUP_TITLE"});t.halt(),e.rapidTracker.beacon(this.name,"uploadButtonClick"),(n=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-upload",signUpTitle:o,beaconPrefix:"upload"})).on("signUpClick",function(t){e.SigninHelper._redirectToSignUp("upload",{postLoginUrl:i})}),n.on("signInClick",function(t){e.SigninHelper._redirectToSignin("upload",{postLoginUrl:i})}),n.show()},executeSearch:function(e){var t,n=this.get("container").one("#gn-search-field").getDOMNode();t=this.searchUrl.createNewSearch(n.value).getURL(),e.halt(),this.appContext.flapp.navigate(t)},setElementStates:function(e){var t=this.appContext.getViewer(),n=e.isSOHP&&!t.signedIn,i=e.isProPage,o={you_link:!1,you_menu:!1,contacts_menu:!1,groups_menu:!1,explore_menu:!1,weekly_flickr:!1,get_pro_link:!0,upload_icon:!1,account_menu:!1,search_bar:!1,signup_link:!1,signin_link:!1,right_side_signup:!0,vr_link:!0,sidebar_signin_link:!1};return n?(o.search_bar=!0,o.signin_link=!0,o.signup_link=!0,o.get_pro_link=!1):i?(o.you_menu=!1,o.explore_menu=!1,o.upload_icon=!1,o.search_bar=!1,o.account_menu=!0,o.get_pro_link=!1):t.signedIn?(o.you_menu=!0,o.explore_menu=!0,o.upload_icon=!0,o.search_bar=!0,o.account_menu=!0):(o.signup_link=!0,o.explore_menu=!0,o.upload_icon=!0,o.search_bar=!0,o.signin_link=!0),this.get("viewer")&&this.get("viewer").getValue("isPro")&&(o.stats=!0,o.get_pro_link=!1),"en-us"===this.appContext.lang.toLowerCase()&&(o.weekly_flickr=!0),i||n||(o.prints_menu=!0),o.events_link=!0,o.weekly_flickr=!1,o.vr_link=!1,this.isSOHP||t.signedIn||(o.sidebar_signin_link=!0),o},isExpiringPartnerAccount:function(){var e=this.get("viewer").getValue("expiringPartner");return this.appContext.flipper.isFlipped("enable-partner-account-banner")&&e&&-1===["embedr-route","browser-upgrade-interstitial-route","products-marketplace-eol-route","products-account-payouts-route","error-route"].indexOf(this.appContext.routeConfig.module)},handleToastActionClick:function(t){var n=t&&t.clickEvent?t.clickEvent.target.getAttribute("href"):null;n?e.config.win.location.href=n:this.toastSubview.dismiss()},setProRedirectCookie:function(){var t=new Date;t.setTime(t.getTime()+60*e.config.flickr.upload_blocking.photo_limit_pro_redir_cookie_hours*60*1e3),this.appContext.setCookie({cookieName:e.config.flickr.upload_blocking.photo_limit_pro_redir_cookie_name,cookieValue:1,expires:t,path:"/"})},showOverLimitToast:function(){this.toastSubview&&this.appContext.flipper.isFlipped("enable-upload-limit-messages")&&e.UserLimitsHelper.isOverARRLimit(this.profileModel,this.appContext)&&(this.toastSubview.setup({htmlContent:this.templates("upload-limit-message")({title:this.intlMessage({intlName:"upload-blocking.OVER_UPLOAD_LIMIT_HEAD_FINAL"}),description:this.intlMessage({intlName:"upload-blocking.OVER_UPLOAD_LIMIT_COPY_FINAL",limitCount:e.config.flickr.account.photo_limit.toLocaleString(this.appContext.lang,{maximumFractionDigits:0})}),primaryActionText:this.intlMessage({intlName:"common.GET_PRO"}),secondaryActionText:this.intlMessage({intlName:"common.DISMISS"})}),classList:["urgent"]}),this.toastSubview.on("primaryActionClicked",this.handleToastActionClick.bind(this)),this.toastSubview.on("secondaryActionClicked",this.handleToastActionClick.bind(this)),this.toastSubview.show())},handlePrintClick:function(){"en-us"===this.appContext.lang.toLowerCase()?this.appContext.getCookie(e.config.flickr.flickrprints.dismiss_intro_to_prints_cookie_name)?this.showPrintSelector():this.showIntroToPrintsModal():this.showEnglishPrintWarningModal()},showPrintSelector:function(){var t=this,n=this.intlMessage({intlName:"prints.CHOOSE_PHOTO_TO_GET_PRINTS"}),i=[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream",selected:!0},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets"},{id:"upload",name:this.intlMessage({intlName:"global-nav.UPLOAD"}),value:"upload"}],o=[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream",selected:!0},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets"},{id:"upload",name:this.intlMessage({intlName:"global-nav.UPLOAD"}),value:"upload"}],r=[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream",selected:!0},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets"}],a={appContext:this.appContext,searchable:{yours:!0,contacts:!1,everyone:!1,marketplace:!1}};this.printSelector=new e.Views["photo-selector-view"](a),this.printSelectorModal=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!1,showBodyLines:!0,showCancelButton:!1,showCancelX:!0,title:"",navBarView:new e.Views["fluid-modal-nav-bar-view"]({appContext:this.appContext,links:i,enableSearch:!0,breakpointConfig:[{maxWidth:700,links:o,enableSearch:!1},{maxWidth:500,links:r,enableSearch:!1}]}),actionButtonLabel:this.intlMessage({intlName:"prints.BUY_PRINTS"}),actionButtonDisabled:!0,subview:this.printSelector,width:Math.round(.8*Math.max(1280,e.config.win.innerWidth)),height:Math.round(e.config.win.innerHeight-60),fullWindow:!0,classList:"photo-selector",hideModalOverlay:!1,buttonFlavorText:n,flexLayout:!0}),this.printSelectorModal.show(),this.printSelectorModal.registerEventHandler(e.on("photoSelector:selected",function(e){t.printSelectorModal.enableActionButton(),t.printSelectorModal.setFlavorText(n)})),this.printSelectorModal.registerEventHandler(e.on("photoSelector:unselected",function(e){t.printSelectorModal.disableActionButton()})),this.printSelectorModal.on("actionClick",this.handleBuyPrintClick.bind(t))},handleBuyPrintClick:function(){var t=this,n=this.printSelector.get("selected");e.config.win.location.href;this.printSelectorModal.disableActionButton(!0),this.appContext.getModel("photo-models",n).then(function(n){return t.photoPrintsHelper.canPrintPhoto(n)?t.photoPrintsHelper.registerPrint(n,e.config.win.location.href):e.Promise.reject({message:"Error: Can’t print photo."})}).then(function(t){e.config.win.location.href=t.redirectURL}).catch(function(e){t.printSelectorModal.enableActionButton(),t.printSelectorModal.setFlavorText(e.message||t.intlMessage({intlName:"prints.SOMETHING_WRONG_PREPARING_PRINT"}),!0)})},showEnglishPrintWarningModal:function(t){var n=this;this.englishPrintWarningModal=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!1,showActionButton:!0,actionButtonLabel:this.intlMessage({intlName:"prints.CONTINUE_IN_ENGLISH"}),showCancelButton:!0,cancelButtonLabel:"en-us"===this.appContext.lang.toLowerCase()?this.intlMessage({intlName:"common.GO_BACK_BUTTON"}):this.intlMessage({intlName:"common.CANCEL"}),showCancelX:!1,showHeader:!0,showFooter:!0,title:this.intlMessage({intlName:"prints.ENGLISH_LANGUAGE_AHEAD"}),message:this.intlMessage({intlName:"prints.ORDERING_IS_ENGLISH_ONLY"}),hideModalOverlay:!1}),this.englishPrintWarningModal.show(),this.englishPrintWarningModal.on("actionClick",function(){setTimeout(function(){n.appContext.getCookie(e.config.flickr.flickrprints.dismiss_intro_to_prints_cookie_name)?n.showPrintSelector():n.showIntroToPrintsModal()},0)}),this.englishPrintWarningModal.on("close",function(){})},handleDrawerPageMouseDown:function(e){var t=e.target;t.ancestor(".mobile-nav-drawer",!0)||t.ancestor(".mobile-nav-toggle",!0)||this.hideMobileNavDrawer()},handleDrawerItemClick:function(e){this.hideMobileNavDrawer()},showMobileNavDrawer:function(){var t=this;this.get("container");this.contentContainer.addClass("drawer-open"),this.navDrawerShown=!0,this.navDrawer.addClass("shown"),e.fire("globalNav:navDrawerOpen"),clearTimeout(this.navDrawerOverlayHideTimeout),this.navDrawerOverlay&&(this.navDrawerOverlay.addClass("displayed"),setTimeout(function(){t.navDrawerOverlay.addClass("shown")},10)),this.drawerPageClickHandler||setTimeout(function(){t.drawerPageClickHandler=e.on(["mousedown","touchstart"],t.handleDrawerPageMouseDown.bind(t)),t.registerEventHandler(t.drawerPageClickHandler)},10)},hideMobileNavDrawer:function(){var t=this;this.get("container");this.contentContainer.removeClass("drawer-open"),this.navDrawerShown=!1,this.navDrawer.removeClass("shown"),e.fire("globalNav:navDrawerClosed"),this.navDrawerOverlay&&(this.navDrawerOverlay.removeClass("shown"),this.navDrawerOverlayHideTimeout=setTimeout(function(){t.navDrawerOverlay.removeClass("displayed")},500)),this.drawerPageClickHandler&&(this.detachRegisteredEvent(this.drawerPageClickHandler),this.drawerPageClickHandler=void 0)},prepareOrderConfirmationModal:function(){var t,n=this,i=e.QueryString.parse(e.config.win.location.search.replace("?",""));e.config.win.location.href;this.photoPrintsHelper.isPrintsEnabled()&&i&&void 0!==i.OrderID&&(t=i.OrderID,this.photoPrintsHelper.fetchOrder(t).then(function(e){n.showOrderConfirmationModal({orderId:e.orderId,orderUrl:e.orderUrl,email:e.email})}).catch(function(e){n.showOrderConfirmationModal({})}))},showOrderConfirmationModal:function(t){var n=this,i=this.templates("print-order-confirmation")({orderNum:t.orderId,orderUrl:t.orderUrl,email:t.email,helpUrl:"https://flickrhelp.com/",feedbackUrl:"/help/forum"}),o=new e.Views.FluidModal({appContext:this.appContext,noScroll:!0,hideModalOverlay:!1,maxHeight:!1,showHeader:!1,showFooter:!1,showCancelX:!1,width:460,htmlMessage:i});o.show(),o.on("activated",function(){n.registerEventHandler(o.get("container").one("button.accept-button").on("click",function(){o.close()}))})},showIntroToPrintsModal:function(){var t=this,n=this.templates("intro-to-prints")({}),i=new e.Views.FluidModal({appContext:this.appContext,noScroll:!0,hideModalOverlay:!1,dismissOnOverlayClick:!0,maxHeight:!1,showHeader:!1,showFooter:!1,width:450,contentPadding:0,showCancelX:!0,htmlMessage:n});i.show(),i.on("activated",function(){i.get("container").one(".accept-button").on("click",function(e){i.close()})}),i.on("close",function(){var n=new Date;n.setTime(n.getTime()+36e10),t.appContext.setCookie({cookieName:e.config.flickr.flickrprints.dismiss_intro_to_prints_cookie_name,cookieValue:1,expires:n,path:"/"}),setTimeout(function(){t.showPrintSelector()},0)})},destructor:function(){e.AnchorRepositioner.removeOffset(t)}})},"@VERSION@",{requires:["flickr-view","hermes-template-global-nav","hermes-template-feedback-modal-view","hermes-template-upload-limit-message","hermes-template-print-order-confirmation","hermes-template-intro-to-prints","search-url","search-autosuggest-field-view","querystring-parse-simple","querystring-stringify-simple","notifications-menu-view","url-helper","person-menu-view","group-menu-view","browser-support","fluid-modal-view","signup-modal-view","signin-helper","storage-helper","partner-account-banner-view","featured-toast-view","user-limits-helper","photo-selector-view","fluid-modal-nav-bar-view","banner-view","photo-prints-helper","math-helper","slim-footer-view","subscriptions-helper"],langBundles:["global-nav","common","search","upload-blocking","prints","blurb","thanks"]});YUI.add("hermes-lang-global-nav",function(o,e){o.Intl.add("hermes/global-nav","en-US",{FLICKR_LOGO_ALT:["Flickr logo. If you click it, you'll go home"],YOUR_PHOTOSTREAM:["Your Photostream"],FOLLOWING:["Following"],PHOTOS_OF:["Photos of"],PHOTOS_FROM:["Photos from"],LIST:["List"],COMMUNITIES:["Communities"],GROUPS_LIST:["Groups List"],SEARCH_GROUPS:["Search Groups"],RECENT_DISCUSSIONS:["Recent Discussions"],CREATE_A_GROUP:["Create a Group"],RECENT_PHOTOS:["Recent Photos"],THE_COMMONS:["The Commons"],GETTY_COLLECTION:["Getty Collection"],GALLERIES:["Galleries"],FLICKR_GALLERIES:["Flickr Galleries"],WORLD_MAP:["World Map"],APP_GARDEN:["App Garden"],THE_WEEKLY_FLICKR:["The Weekly Flickr"],FLICKR_BLOG:["Flickr Blog"],UPLOAD:["Upload"],SIGN_IN:["Sign In"],SEARCH:["Search"],CAMERA_FINDER:["Camera Finder"],RECENT_ACTIVITY:["Recent Activity"],STATS:["Stats"],ORGANIZE:["Organize"],CREATIONS:["Creations"],FIND_FRIENDS:["Find Friends"],GROUPS:["Groups"],PEOPLE:["People"],CAMERAROLL:["Camera Roll"],CREATE:["Create"],CREATE_NEW:["New Creation"],CREATE_MY_WALLART:["My Wall Art"],CREATE_MY_PHOTOS_BOOKS:["My Photo Books"],CREATE_ORDER_HISTORY:["My Order History"],UPLOAD_MODAL_SIGNUP_TITLE:["Upload your photos securely and privately!"],UPLOAD_MODAL_SIGNUP_MESSAGE:["Join Flickr to unlock 1,000GB of free photo storage."],HOME:["Home"],LOG_IN:["Log In"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-lang-blurb",function(o,r){o.Intl.add("hermes/blurb","en-US",{ALL_NEW_BOOKS_HEADER:["All-new photos books from Blurb"],ALL_NEW_BOOKS_SUBHEADER_PRO:["Get $35 off your Blurb® purchase.* Use your discount code below at checkout."],ALL_NEW_BOOKS_SUBHEADER_NONPRO:['Get $35 off your Blurb® purchase.* <a href="',"${url}",'">Learn more</a>'],GET_DISCOUNT_WITH_PRO:["Get $35 off with your Flickr Pro subscription"],PRINT_WITH_BLURB:["Print your photo books with Blurb®."],ASTERIX:["* With minimum purchase of $70. Offer available for 1-year and 2-year Flickr Pro subscriptions. Discount available once per year."],ASTERIX_V2:["* Get $35 dollars off your Photo Book purchase up to 4 times a year! Valid for orders of $70 or more when you're on an annual Flickr Pro plan."],ASTERIX_MINIMUM:["* With minimum purchase of $70."],ALL_NEW_BOOKS_SUBHEADER_2:["Use your discount code below at checkout."],LAUNCH_BlURB_BOOKIFY:["Launch Blurb Bookify"],CUSTOMIZE_BOOK_HEADER:["Customize your book."],MAKE_A_BOOK:["Make a book"],COLUMNS_CREATE:["Create."],COLUMNS_CREATE_TEXT:["Connect your Flickr account to Blurb and start your book. You can easily import your photostream and albums into the book layout."],COLUMNS_PRINT:["Print."],COLUMNS_PRINT_TEXT:["Get all the options you need for your project, including digital output, print on demand, and offset printing. Plus, choose from a wide range of paper options. It’s all up to you."],COLUMNS_SELL:["Sell."],COLUMNS_SELL_TEXT:['Choose from a range of distribution options, including Amazon, Ingram, and the Blurb Bookstore. As a Flickr Pro, you can now promote your books on Flickr as well. <a href="',"${url}",'">Learn more</a>'],COLUMNS_CUSTOMIZE:["Customize."],COLUMNS_CUSTOMIZE_TEXT:["Take advantage of Blurb’s many sizes, paper choices, and styles. Unleash your creativity with captions, text, and countless photo layouts."],ANOTHER_STUNNING_SHOT:["Another stunning photo shoot!"],WANT_MORE_CREATIVE:["Want more creative control?"],USE_FAVORITE_TOOLS:["Use your favorite Adobe & PDF tools."],CREATIVE_TEXT:['Lay out your book, magazine, or ebook with your favorite tools. Get easy print setup with Blurb’s plug-in for Adobe InDesign and Adobe Lightroom Book Module. Or, design with any app and use Blurb’s PDF uploader. <a href="',"${url}",'">Learn more</a>'],BLURB_SHARE:["Share."],BLURB_SHARE_TEXT:["Once you receive your Blurb book, share it with the Flickr community. Join the official Blurb Books group on Flickr and inspire others with your creations."],BLURB_BULLET_LIST_ONE:["1"],BLURB_BULLET_LIST_SECOND:["2"],BLURB_BULLET_LIST_THIRD:["3"],UPGRADE_TO_PRO_BTN:["Upgrade to Pro"],UPGRADE_YOUR_PRO_BTN:["Upgrade your Pro"],COPY_BLURB_CODE:["Copy"],COPY_COPIED:["Copied!"],PHOTO_BOOKS:["Photo Books"],PRO_BLURB_SECTION_TEXT:["Use Blurb's free book-creation tools for complete creative control. Get $35 off your first Blurb purchase with a yearly Pro subscription (minimum $70 Blurb purchase)."],BLURB_PRODUCT_PROMO_DESCRIPTION_TEXT:["Use Blurb's free book-creation tools for complete creative control. Get $35 dollars off your Photo Book purchase up to 4 times a year. Valid for orders of $70 or more."]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-lang-thanks",function(a,e){a.Intl.add("hermes/thanks","en-US",{THANK_YOU_USER:['<span class="thank-you-text">Thank you,</span> <span class="thank-you-name">',"${displayName}","</span>"],THANK_YOU_MESSAGE:["You've helped make Flickr a special place for so many years. We hope to delight you for many more."],PS_HAVE_A_WISH:["P.S. — Have a wish for Flickr?"],LET_US_KNOW:["Let us know!"]})},"@VERSION@",{requires:["intl"]});YUI.add("empty-photo-page-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},additionalViewClasses:function(){var e=[];return this.appContext.getViewer().signedIn||e.push("has-global-nav"),e},buildContainer:function(){return this.setContainerWithTemplate("empty-photo-page"),this}},{ATTRS:{spaceid:{value:792600606}}})},"@VERSION@",{requires:["flickr-view","hermes-template-empty-photo-page","overflow-helper","url"],optional:["global-nav-view"],langBundles:["common","photo-page-scrappy"]});YUI.add("hermes-template-photo-page-lightbox",function(e,t){var a=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,t,a,l,r){var n=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return e.escapeExpression((n(a,"outlet")||t&&n(t,"outlet")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?n(t,"photo-well-view"):t,{name:"outlet",hash:{},data:r,loc:{start:{line:1,column:0},end:{line:1,column:26}}}))+"\n"},useData:!0}),l={};e.Array.each([],function(t){var a=e.Template.get("hermes/"+t);a&&(l[t]=a)}),e.Template.register("hermes/photo-page-lightbox",function(t,r){return r=r||{},r.partials=r.partials?e.merge(l,r.partials):l,a(t,r)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-photo-card-engagement",function(n,e){var t=n.Template.Handlebars.revive({1:function(n,e,t,l,a){return" theme-overlay"},3:function(n,e,t,l,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"\t\t"+n.escapeExpression((o(t,"outlet")||e&&o(e,"outlet")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},null!=e?o(e,"like-engagement-item-view"):e,{name:"outlet",hash:{},data:a,loc:{start:{line:5,column:2},end:{line:5,column:38}}}))+"\n"},5:function(n,e,t,l,a){var o,r=null!=e?e:n.nullContext||{},u=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t<span role="button" class="engagement-item fave '+(null!=(o=u(t,"if").call(r,null!=(o=null!=(o=null!=e?u(e,"photoItem"):e)?u(o,"engagement"):o)?u(o,"isFaved"):o,{name:"if",hash:{},fn:n.program(6,a,0),inverse:n.noop,data:a,loc:{start:{line:7,column:50},end:{line:7,column:99}}}))?o:"")+(null!=(o=u(t,"if").call(r,null!=(o=null!=(o=null!=e?u(e,"photoItem"):e)?u(o,"engagement"):o)?u(o,"canFave"):o,{name:"if",hash:{},fn:n.noop,inverse:n.program(8,a,0),data:a,loc:{start:{line:7,column:99},end:{line:7,column:155}}}))?o:"")+'" tabindex="0">\n\t\t\t<span class="engagement-icon">\n\t\t\t\t<i class="animated-fave-star"></i>\n\t\t\t</span>\n\t\t\t<span class="engagement-count'+(null!=(o=u(t,"if").call(r,null!=(o=null!=(o=null!=e?u(e,"photoItem"):e)?u(o,"engagement"):o)?u(o,"faveCount"):o,{name:"if",hash:{},fn:n.noop,inverse:n.program(10,a,0),data:a,loc:{start:{line:11,column:32},end:{line:11,column:83}}}))?o:"")+'">\n\t\t\t\t'+(null!=(o=u(t,"if").call(r,null!=(o=null!=(o=null!=e?u(e,"photoItem"):e)?u(o,"engagement"):o)?u(o,"faveCount"):o,{name:"if",hash:{},fn:n.program(12,a,0),inverse:n.noop,data:a,loc:{start:{line:12,column:4},end:{line:12,column:96}}}))?o:"")+"\n\t\t\t</span>\n\t\t</span>\n"},6:function(n,e,t,l,a){return" faved"},8:function(n,e,t,l,a){return" can-not-fave"},10:function(n,e,t,l,a){return" empty"},12:function(n,e,t,l,a){var o,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return n.escapeExpression((r(t,"formatNumber")||e&&r(e,"formatNumber")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},null!=(o=null!=(o=null!=e?r(e,"photoItem"):e)?r(o,"engagement"):o)?r(o,"faveCount"):o,{name:"formatNumber",hash:{},data:a,loc:{start:{line:12,column:42},end:{line:12,column:89}}}))},14:function(n,e,t,l,a){var o,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return n.escapeExpression((r(t,"formatNumber")||e&&r(e,"formatNumber")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},null!=(o=null!=(o=null!=e?r(e,"photoItem"):e)?r(o,"engagement"):o)?r(o,"commentCount"):o,{name:"formatNumber",hash:{},data:a,loc:{start:{line:22,column:44},end:{line:22,column:94}}}))},16:function(n,e,t,l,a){return'\t\t<span role="button" class="engagement-item curate" tabindex="0">\n\t\t\t<span class="engagement-icon">\n\t\t\t\t<svg class="icon icon-curate"><use xlink:href="#icon-curate"></use></svg>\n\t\t\t</span>\n\t\t</span>\n'},18:function(n,e,t,l,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"\t\t"+n.escapeExpression((o(t,"outlet")||e&&o(e,"outlet")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},null!=e?o(e,"fluid-share-photo-view"):e,{name:"outlet",hash:{},data:a,loc:{start:{line:33,column:2},end:{line:33,column:35}}}))+"\n"},compiler:[8,">= 4.3.0"],main:function(n,e,t,l,a){var o,r=null!=e?e:n.nullContext||{},u=n.hooks.helperMissing,i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<div class="photo-card-engagement\n\t'+(null!=(o=(i(t,"ifCond")||e&&i(e,"ifCond")||u).call(r,null!=e?i(e,"theme"):e,"===","overlay",{name:"ifCond",hash:{},fn:n.program(1,a,0),inverse:n.noop,data:a,loc:{start:{line:2,column:1},end:{line:2,column:59}}}))?o:"")+'">\n\n'+(null!=(o=(i(t,"isFlipped")||e&&i(e,"isFlipped")||u).call(r,"enable-likes",{name:"isFlipped",hash:{},fn:n.program(3,a,0),inverse:n.program(5,a,0),data:a,loc:{start:{line:4,column:1},end:{line:15,column:15}}}))?o:"")+'\t\n\t<span role="button" class="engagement-item comment" tabindex="0">\n\t\t<span class="engagement-icon">\n\t\t\t<svg class="icon icon-comment_hollow"><use xlink:href="#icon-comment_hollow"></use></svg>\n\t\t</span>\n\t\t<span class="engagement-count'+(null!=(o=i(t,"if").call(r,null!=(o=null!=(o=null!=e?i(e,"photoItem"):e)?i(o,"engagement"):o)?i(o,"commentCount"):o,{name:"if",hash:{},fn:n.noop,inverse:n.program(10,a,0),data:a,loc:{start:{line:21,column:31},end:{line:21,column:85}}}))?o:"")+'">\n\t\t\t'+(null!=(o=i(t,"if").call(r,null!=(o=null!=(o=null!=e?i(e,"photoItem"):e)?i(o,"engagement"):o)?i(o,"commentCount"):o,{name:"if",hash:{},fn:n.program(14,a,0),inverse:n.noop,data:a,loc:{start:{line:22,column:3},end:{line:22,column:101}}}))?o:"")+"\n\t\t</span>\n\t</span>\n"+(null!=(o=i(t,"if").call(r,null!=e?i(e,"displayCurate"):e,{name:"if",hash:{},fn:n.program(16,a,0),inverse:n.noop,data:a,loc:{start:{line:25,column:1},end:{line:31,column:8}}}))?o:"")+(null!=(o=i(t,"if").call(r,null!=e?i(e,"displayShare"):e,{name:"if",hash:{},fn:n.program(18,a,0),inverse:n.noop,data:a,loc:{start:{line:32,column:1},end:{line:34,column:8}}}))?o:"")+"</div>\n"},useData:!0}),l={};n.Array.each([],function(e){var t=n.Template.get("hermes/"+e);t&&(l[e]=t)}),n.Template.register("hermes/photo-card-engagement",function(e,a){return a=a||{},a.partials=a.partials?n.merge(l,a.partials):l,t(e,a)})},"@VERSION@",{requires:["template-base","handlebars-base"]});